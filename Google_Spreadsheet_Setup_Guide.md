# Google Sheets 整合設定指南

本指南將協助您設定 Google Apps Script 和 Google Sheets，以便從報紙職缺提取器直接發送資料到您的試算表。

## 📋 目錄

1. [建立 Google Sheets](#1-建立-google-sheets)
2. [設定 Google Apps Script](#2-設定-google-apps-script)
3. [部署網路應用程式](#3-部署網路應用程式)
4. [測試連接](#4-測試連接)
5. [使用說明](#5-使用說明)
6. [常見問題](#6-常見問題)

## 1. 建立 Google Sheets

### 步驟 1.1：建立新的試算表
1. 前往 [Google Sheets](https://sheets.google.com)
2. 點擊「空白」建立新的試算表
3. 將試算表重新命名為「報紙職缺資料」或您喜歡的名稱
4. 複製試算表的 ID（URL 中 `/d/` 和 `/edit` 之間的部分）

### 步驟 1.2：記錄試算表 ID
```
範例 URL: https://docs.google.com/spreadsheets/d/1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms/edit
試算表 ID: 1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms
```

## 2. 設定 Google Apps Script

### 步驟 2.1：建立新的 Apps Script 專案
1. 前往 [Google Apps Script](https://script.google.com)
2. 點擊「新增專案」
3. 將專案重新命名為「報紙職缺資料接收器」

### 步驟 2.2：設定程式碼
1. 刪除預設的 `myFunction()` 函數
2. 將本專案中的 `google_apps_script.js` 檔案內容完整複製貼上
3. 修改第 16 行的 `SPREADSHEET_ID`：
   ```javascript
   const SPREADSHEET_ID = '您的試算表ID';
   ```
4. 點擊「儲存」（Ctrl+S）

### 步驟 2.3：設定權限
1. 點擊「執行」按鈕測試 `doPost` 函數
2. 當出現授權請求時，點擊「檢閱權限」
3. 選擇您的 Google 帳戶
4. 點擊「進階」→「前往報紙職缺資料接收器（不安全）」
5. 點擊「允許」授予必要權限

## 3. 部署網路應用程式

### 步驟 3.1：部署設定
1. 點擊右上角的「部署」按鈕
2. 選擇「新增部署」
3. 在「類型」中選擇「網路應用程式」
4. 設定以下選項：
   - **說明**：報紙職缺資料接收器 v1.0
   - **執行身分**：我
   - **存取權限**：任何人

### 步驟 3.2：完成部署
1. 點擊「部署」
2. 複製「網路應用程式 URL」（這就是您需要的 Apps Script URL）
3. 點擊「完成」

### 步驟 3.3：記錄 URL
```
範例 URL: https://script.google.com/macros/s/AKfycbx...../exec
```
**重要：請妥善保存此 URL，您將在報紙職缺提取器中使用它**

## 4. 測試連接

### 步驟 4.1：測試 Apps Script
1. 在瀏覽器中開啟您的 Apps Script URL
2. 應該會看到類似以下的回應：
   ```json
   {
     "success": true,
     "message": "Google Apps Script 運行正常",
     "data": {
       "method": "GET",
       "timestamp": "2024-01-01T12:00:00.000Z"
     }
   }
   ```

### 步驟 4.2：檢查試算表
1. 回到您的 Google Sheets
2. 確認可以正常開啟和編輯

## 5. 使用說明

### 步驟 5.1：在報紙職缺提取器中使用
1. 完成圖片處理後，進入結果頁面
2. 點擊「下載結果」按鈕
3. 點擊「發送到 Google Sheets」
4. 貼上您的 Apps Script URL
5. 點擊「發送資料」

### 步驟 5.2：查看結果
1. 發送成功後，前往您的 Google Sheets
2. 查看「職缺資料」工作表
3. 所有職缺資料將會自動整理在表格中

## 6. 資料結構說明

發送到 Google Sheets 的資料包含以下欄位：

| 欄位名稱 | 說明 | 範例 |
|---------|------|------|
| 添加時間 | 資料添加的時間戳記 | 2024-01-01 12:00:00 |
| 工作 | 職位名稱 | 軟體工程師 |
| 行業 | 所屬行業 | 資訊科技業 |
| 時間 | 工作時間 | 週一至週五 9:00-18:00 |
| 薪資 | 薪資待遇 | 月薪 50,000-70,000 元 |
| 地點 | 工作地點 | 台北市信義區 |
| 聯絡方式 | 聯絡資訊 | 02-1234-5678 |
| 其他 | 其他資訊 | 需具備 Python 經驗 |
| 來源圖片 | 來源圖片檔名 | job_block_1.jpg |
| 頁碼 | PDF 頁碼（如適用） | 1 |
| 工作編號 | 圖片中的工作編號 | 工作 1 |
| 圖片編號 | 圖片識別碼 | page1_job_block_1 |
| 處理ID | 處理批次 ID | abc123def456 |
| 來源系統 | 資料來源系統 | newspaper_job_extractor |

## 7. 常見問題

### Q1: 為什麼我收到「權限被拒絕」的錯誤？
**A:** 請確認：
- Apps Script 已正確授權
- 試算表 ID 正確
- 部署設定中的「存取權限」設為「任何人」

### Q2: 資料沒有出現在試算表中怎麼辦？
**A:** 請檢查：
- Apps Script URL 是否正確
- 試算表是否可以正常開啟
- 查看 Apps Script 的執行記錄是否有錯誤

### Q3: 如何查看 Apps Script 的執行記錄？
**A:** 
1. 前往 Apps Script 編輯器
2. 點擊左側的「執行」
3. 查看最近的執行記錄和任何錯誤訊息

### Q4: 可以修改試算表的欄位嗎？
**A:** 可以，但請注意：
- 不要刪除或重新命名「職缺資料」工作表
- 可以在現有欄位後面添加新欄位
- 如需修改欄位結構，請同時修改 Apps Script 程式碼

### Q5: 如何更新 Apps Script 程式碼？
**A:**
1. 前往 Apps Script 編輯器
2. 修改程式碼
3. 點擊「儲存」
4. 點擊「部署」→「管理部署」
5. 點擊編輯圖示，選擇「新版本」
6. 點擊「部署」

## 8. 安全性注意事項

1. **URL 保密**：請不要公開分享您的 Apps Script URL
2. **權限管理**：定期檢查 Apps Script 的權限設定
3. **資料備份**：建議定期備份您的試算表資料
4. **存取記錄**：可以在 Apps Script 中查看執行記錄

## 9. 進階功能

### 自訂資料處理
您可以修改 `google_apps_script.js` 中的 `addJobsToSpreadsheet` 函數來：
- 添加資料驗證
- 自訂資料格式
- 添加自動計算欄位
- 設定條件格式

### 多工作表支援
如需將不同類型的職缺分別儲存到不同工作表，可以修改程式碼中的工作表邏輯。

---

## 📞 技術支援

如果您在設定過程中遇到問題，請：
1. 檢查本指南的常見問題部分
2. 確認所有步驟都已正確完成
3. 查看 Apps Script 的執行記錄
4. 檢查瀏覽器的開發者工具中的錯誤訊息

**祝您使用愉快！** 🎉 