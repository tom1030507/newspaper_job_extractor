# Google Spreadsheet 自動創建功能

本系統現在支援自動創建 Google Spreadsheet 並將職缺資料匯入，無需手動設定 Google Apps Script URL。

## 🎯 功能特點

### ✨ 自動創建 Google Sheet
- **一鍵創建**：點擊「創建 Google Spreadsheet」按鈕即可自動創建試算表
- **自動命名**：根據處理時間自動生成有意義的檔案名稱
- **美觀格式**：自動設定標題行樣式、顏色和邊框

### 📊 完整資料匯入
- **職缺資料**：包含工作、行業、薪資、地點等完整資訊
- **處理摘要**：顯示處理統計和行業分布
- **來源追蹤**：記錄每筆資料的來源圖片和頁碼

### 🔗 即時連結分享
- **直接開啟**：創建完成後提供 Google Sheet 連結
- **複製連結**：一鍵複製連結功能
- **權限設定**：自動設定為「有連結的人都可檢視」

## 🚀 使用方法

### 第一步：處理圖片
1. 在首頁上傳 PDF 或圖片檔案
2. 系統自動進行區塊分割和文字識別
3. 等待處理完成

### 第二步：檢視結果
1. 在結果頁面查看識別出的職缺資訊
2. 確認資料正確性

### 第三步：創建 Google Sheet
1. 點擊「創建 Google Spreadsheet」按鈕
2. 等待系統自動創建試算表
3. 點擊「開啟 Google Spreadsheet」查看結果

## 📋 Google Sheet 內容

### 主要工作表「職缺資料」

| 欄位 | 說明 |
|------|------|
| 編號 | 自動遞增編號 |
| 工作 | 工作職位名稱 |
| 行業 | 19個標準行業分類 |
| 時間 | 工作時間或營業時間 |
| 薪資 | 薪資待遇或收入 |
| 地點 | 工作地點或地址 |
| 聯絡方式 | 電話、地址等聯絡資訊 |
| 其他 | 其他相關資訊或備註 |
| 來源圖片 | 原始圖片檔名 |
| 頁碼 | PDF 頁碼（如適用） |
| 工作編號 | 同一圖片中的工作序號 |
| 提取時間 | 資料提取的時間戳記 |

### 摘要工作表「處理摘要」
- 處理 ID 和總職缺數
- 處理時間和資料來源
- 各行業職缺分布統計

## ⚙️ 技術原理

### 系統架構
```
用戶界面 → Flask 後端 → Google Apps Script → Google Sheets API → 創建試算表
```

### 資料流程
1. **資料收集**：從圖片識別結果收集職缺資訊
2. **資料清理**：過濾無效或重複的工作資訊
3. **格式轉換**：將資料轉換為 Google Apps Script 可處理的格式
4. **遠端創建**：透過 HTTP POST 請求呼叫 Google Apps Script
5. **回應處理**：接收創建的 Google Sheet URL 並顯示給用戶

### 安全性考量
- **匿名存取**：使用公開的 Google Apps Script，無需登入
- **資料隔離**：每次處理都創建獨立的試算表
- **權限控制**：試算表預設為檢視權限

## 🛠️ 故障排除

### 常見問題

**問題：點擊創建按鈕後沒有反應**
- 檢查網路連線
- 確認沒有職缺資料時無法創建
- 刷新頁面重試

**問題：創建失敗顯示錯誤**
- Google Apps Script 服務可能暫時不可用
- 稍後重試或聯繫系統管理員

**問題：無法開啟 Google Sheet 連結**
- 確認已使用 Google 帳號登入
- 檢查瀏覽器是否阻擋彈出視窗

### 除錯方法
1. 開啟瀏覽器開發者工具查看網路請求
2. 檢查 Flask 應用程式的日誌輸出
3. 確認 Google Apps Script 部署狀態

## 🔧 自訂設定

### 使用自己的 Google Apps Script

如果您想使用自己的 Google Apps Script：

1. 按照 `GOOGLE_APPS_SCRIPT_SETUP.md` 設置您的 Google Apps Script
2. 在結果頁面的模態框中展開「自訂 Google Apps Script URL」選項
3. 輸入您的 Google Apps Script URL
4. 點擊創建

### 修改資料格式

您可以修改 `google_apps_script.js` 中的代碼來：
- 調整工作表欄位
- 修改格式樣式
- 增加自定義統計

## 📞 技術支援

如遇到技術問題，請：
1. 查看 `GOOGLE_APPS_SCRIPT_SETUP.md` 詳細說明
2. 檢查系統日誌輸出
3. 聯繫開發團隊

---

💡 **提示**：此功能完全免費使用，創建的 Google Sheet 會保存在執行 Google Apps Script 的帳號中。 